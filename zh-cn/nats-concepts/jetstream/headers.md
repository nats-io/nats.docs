# 标头

消息标头在多种 JetStream 上下文中使用，例如去重、自动清除消息、重新发布消息的元数据等。

## 发布

客户端在发布消息时可以设置的标头。

| 名称                                  | 描述                                                                                                                                                                                                       | 示例                                | 版本 |
| :------------------------------------ | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------- | :------ |
| `Nats-Msg-Id`                         | 客户端定义的消息唯一标识符，服务器将在配置的“重复窗口”内使用该标识符进行去重。                                                                     | `9f01ccf0-8c34-4789-8688-231a2538a98b` | 2.2.0   |
| `Nats-Expected-Stream`                | 用于断言发布的消息将被某个预期的流接收。                                                                                                                                         | `my-stream`                            | 2.2.0   |
| `Nats-Expected-Last-Msg-Id`           | 用于在流级别应用乐观并发控制。该值为最后一个预期的 `Nats-Msg-Id`，如果当前 ID 不匹配，服务器将拒绝发布。                             | `9f01ccf0-8c34-4789-8688-231a2538a98b` | 2.2.0   |
| `Nats-Expected-Last-Sequence`         | 用于在流级别应用乐观并发控制。该值为最后一个预期的序列号，如果当前序列号不匹配，服务器将拒绝发布。                            | `328`                                  | 2.2.0   |
| `Nats-Expected-Last-Subject-Sequence` | 用于在主题级别应用乐观并发控制。该值为最后一个预期的序列号，如果当前序列号不匹配消息的主题，服务器将拒绝发布。 | `38`                                   | 2.3.1   |
| `Nats-Rollup`                         | 用于清除流或主题级别之前的所有消息。                                                                                                                                | `all` 表示流级别，`sub` 表示主题级别    | 2.6.2   |

## 重新发布

重新发布消息时设置的标头。

| 名称                 | 描述                                                                                                            | 示例                       | 版本 |
| :------------------- | :----------------------------------------------------------------------------------------------------------------- | :---------------------------- | :------ |
| `Nats-Stream`        | 消息重新发布的流名称。                                                                                   | `Nats-Stream: my-stream`      | 2.8.3   |
| `Nats-Subject`       | 消息的原始主题。                                                                                   | `events.mouse_clicked`        | 2.8.3   |
| `Nats-Sequence`      | 消息的原始序列号。                                                                                  | `193`                         | 2.8.3   |
| `Nats-Last-Sequence` | 具有相同主题的消息的最后一个序列号，如果没有，则为零。 | `190`                         | 2.8.3   |
| `Nats-Time-Stamp`    | 消息的原始时间戳。                                                                                 | `2023-08-23T19:53:05.762416Z` | 2.10.0  |

## 源（Sources）

隐式添加到从其他流获取的消息的标头。

| 名称                 | 描述                                                                                                                                           | 示例     | 版本 |
| :------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------- | :---------- | :------ |
| `Nats-Stream-Source` | 指定原始流名称、主题和序列号，以及正在获取的消息的主题过滤器和目标转换。 | `my-stream` | 2.2.0   |

## 仅标头

当消费者配置为“仅标头”时添加到消息的标头，省略消息体。

| 名称            | 描述                          | 示例 | 版本 |
| :-------------- | :----------------------------------- | :------ | :------ |
| `Nats-Msg-Size` | 表示消息大小（字节）。 | `1024`  | 2.6.2   |

## 镜像

镜像内部流量控制消息使用的标头。

| 名称                    | 描述 | 示例 | 版本 |
| :---------------------- | :---------- | :------ | :------ |
| `Nats-Last-Consumer`    |             |         | 2.2.1   |
| `Nats-Last-Stream`      |             |         | 2.2.1   |
| `Nats-Consumer-Stalled` |             |         | 2.4.0   |
| `Nats-Response-Type`    |             |         | 2.6.4   |