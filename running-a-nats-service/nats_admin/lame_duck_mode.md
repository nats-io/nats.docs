# Режим Lame Duck

В продакшене рекомендуется останавливать сервер через ​lame duck mode​ — корректный способ постепенно «вытеснить» клиентов. В крупных установках это снижает эффект «громовой стаи», когда TLS‑клиенты массово переподключаются и создают нагрузку на CPU серверов.

## Сервер

Lame duck mode включается через [сигнал](signals.md) серверу:

```shell
nats-server --signal ldm
```

После входа в lame duck mode сервер перестает принимать новые соединения, ждет 10‑секундный grace‑период, затем начинает постепенно отключать клиентов в течение времени, задаваемого опцией конфигурации [lame_duck_duration](https://docs.nats.io/nats-server/configuration#runtime-configuration). По умолчанию это 2 минуты.

## Клиенты

При входе в lame duck mode сервер отправляет сообщение клиентам. Некоторые официально поддерживаемые клиенты вызывают опциональный callback, указывающий, что сервер входит в lame duck mode. Это полезно, когда приложению нужно подготовиться к краткому простою между моментом отключения и автоматическим переподключением к другому серверу.
