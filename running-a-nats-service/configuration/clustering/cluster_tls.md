# TLS‑аутентификация в кластерах

При настройке кластеров все серверы в кластере, если используется TLS, будут проверять как подключающиеся endpoints, так и ответы серверов. Поэтому сертификаты проверяются [в обоих направлениях](/running-a-nats-service/configuration/securing_nats/tls.md#wrong-key-usage). Сертификаты можно настроить только для кластерной идентичности сервера, отделяя клиентские и серверные сертификаты от формирования кластера.

Взаимная TLS‑аутентификация _— единственный способ_ защитить маршруты.

```
cluster {
  listen: 127.0.0.1:4244

  tls {
    # Сертификат route
    cert_file: "./configs/certs/srva-cert.pem"
    # Приватный ключ
    key_file:  "./configs/certs/srva-key.pem"
    # Необязательный CA, проверяющий подключающиеся маршруты
    # Требуется, когда используется самоподписанный CA и т. п.
    ca_file:   "./configs/certs/ca.pem"
  }
  # Маршруты активно запрашиваются и подключаются с этого сервера.
  # Другие серверы могут подключаться к нам, если предоставят правильные учетные данные
  # в их определениях routes выше.
  routes = [
    nats://127.0.0.1:4246
  ]
}
```
