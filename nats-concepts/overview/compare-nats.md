---
description: 'Сравнение NATS с Kafka, Rabbit, gRPC и другими'
---

# Сравнение NATS

Это сравнение возможностей — краткий обзор нескольких ключевых компонентов популярных сегодня технологий обмена сообщениями. Оно не является исчерпывающим, и каждую технологию следует изучить отдельно, чтобы понять, что лучше подходит для вашей реализации.

В этом сравнении рассматриваются NATS, Apache Kafka, RabbitMQ, Apache Pulsar и gRPC.

## Охват языков и платформ

| Проект | Клиентские языки и платформы |
| :--- | :--- |
| **NATS** | Core NATS: 48 известных типов клиентов, 11 поддерживаются сопровождающими, 18 предоставлены сообществом. NATS Streaming: 7 типов клиентов поддерживаются сопровождающими, 4 предоставлены сообществом. Серверы NATS могут быть собраны под архитектуры, поддерживаемые Golang. NATS предоставляет бинарные дистрибутивы. |
| **gRPC** | 13 клиентских языков. |
| **Kafka** | 18 типов клиентов поддерживаются сообществом и Confluent. Серверы Kafka могут работать на платформах с поддержкой Java; очень широкий охват. |
| **Pulsar** | 7 клиентских языков, 5 сторонних клиентов — протестировано на macOS и Linux. |
| **Rabbit** | Не менее 10 клиентских платформ поддерживаются сопровождающими, и более 50 типов клиентов поддерживаются сообществом. Серверы поддерживаются на следующих платформах: Linux, Windows NT. |

## Встроенные паттерны

| Проект | Поддерживаемые паттерны |
| :--- |:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **NATS** | Потоки и сервисы через встроенные паттерны publish/subscribe, request-reply и очереди с балансировкой нагрузки. Поддерживаются динамические права на запросы и обфускация тем запросов. |
| **gRPC** | Один сервис (возможно со streaming‑семантикой) на канал. Балансировка нагрузки для сервиса выполняется либо на стороне клиента, либо через прокси. |
| **Kafka** | Потоки через publish/subscribe. Балансировка нагрузки достигается с помощью consumer groups. Код приложения должен сопоставлять запросы и ответы через несколько тем для паттерна сервисов \(request-reply\). |
| **Pulsar** | Потоки через publish/subscribe. Несколько конкурирующих паттернов потребителей поддерживают балансировку нагрузки. Код приложения должен сопоставлять запросы и ответы через несколько тем для паттерна сервисов \(request-reply\). |
| **Rabbit** | Потоки через publish/subscribe и сервисы с возможностью direct reply-to. Балансировка нагрузки достигается через Work Queue. Приложения должны сопоставлять запросы и ответы через несколько тем для паттерна сервисов \(request-reply\). |

## Гарантии доставки

| Проект | QoS / гарантии |
| :--- | :--- |
| **NATS** | В JetStream доступны режимы at most once, at least once и exactly once. |
| **gRPC** | At most once. |
| **Kafka** | At most once, at least once и exactly once. |
| **Pulsar** | At most once, at least once и exactly once. |
| **Rabbit** | At most once, at least once. |

## Мультиарендность и совместное использование

| Проект | Поддержка мультиарендности |
| :--- | :--- |
| **NATS** | NATS поддерживает настоящую мультиарендность и децентрализованную безопасность через аккаунты и определение общих потоков и сервисов. |
| **gRPC** | Н/Д |
| **Kafka** | Мультиарендность не поддерживается. |
| **Pulsar** | Мультиарендность реализована через tenants; встроенного обмена данными между tenants нет. Каждый tenant может иметь свою схему аутентификации и авторизации. |
| **Rabbit** | Мультиарендность поддерживается через vhosts; совместное использование данных не поддерживается. |

## AuthN

| Проект | Аутентификация |
| :--- | :--- |
| **NATS** | NATS поддерживает TLS, NATS credentials, NKEYS \(ключи NATS ED25519\), имя пользователя и пароль или простой токен. |
| **gRPC** | TLS, ALT, Token, учетные данные канала и вызова, а также механизм плагинов. |
| **Kafka** | Поддерживает Kerberos и TLS. Поддерживает JAAS и встроенный механизм авторизации, использующий ZooKeeper для хранения соединений и тем. |
| **Pulsar** | TLS‑аутентификация, Athenz, Kerberos, аутентификация по JSON Web Token. |
| **Rabbit** | TLS, SASL, имя пользователя и пароль и подключаемая авторизация. |

## AuthZ

| Проект | Авторизация |
| :--- | :--- |
| **NATS** | Лимиты аккаунтов, включая число соединений, размер сообщения, число импортов и экспортов. Права публикации/подписки на уровне пользователя, ограничения соединений, ограничения по CIDR‑адресам и по времени суток. |
| **gRPC** | Пользователи могут настраивать учетные данные вызова для тонкой авторизации отдельных вызовов сервиса. |
| **Kafka** | Поддерживает JAAS, ACL для богатого набора ресурсов Kafka, включая темы, кластеры, группы и другие. |
| **Pulsar** | Права могут назначаться конкретным ролям на списки операций, таких как produce и consume. |
| **Rabbit** | ACL определяют права на операции configure, write и read над ресурсами вроде exchanges, queues, transactions и другими. Аутентификация подключаемая. |

## Хранение сообщений и персистентность

| Проект | Поддержка хранения и персистентности сообщений |
| :--- | :--- |
| **NATS** | Поддерживает персистентность в памяти и на диске. Сообщения можно воспроизводить по времени, количеству или номеру последовательности, поддерживаются durable‑подписки. В NATS Streaming скрипты могут архивировать старые сегменты логов в cold storage. |
| **gRPC** | Н/Д |
| **Kafka** | Поддерживает дисковую персистентность. Сообщения можно воспроизводить, указав offset, поддерживаются durable‑подписки. Также поддерживаются log compaction и KSQL. |
| **Pulsar** | Поддерживает многоуровневое хранилище, включая файлы, Amazon S3 или Google Cloud Storage \(GCS\). Pulsar может воспроизводить сообщения с конкретной позиции и поддерживает durable‑подписки. Поддерживаются Pulsar SQL и compaction тем, а также Pulsar functions. |
| **Rabbit** | Поддерживает дисковую персистентность. Rabbit использует семантику очередей \(в отличие от лога\), поэтому повторная выдача сообщений недоступна. |

## Высокая доступность и отказоустойчивость

| Проект | Поддержка HA/FT |
| :--- | :--- |
| **NATS** | Core NATS поддерживает full‑mesh кластеризацию с самовосстановлением для высокой доступности клиентов. NATS Streaming имеет warm failover резервные серверы в двух режимах \(FT и полная кластеризация\). JetStream поддерживает горизонтальное масштабирование со встроенным зеркалированием. |
| **gRPC** | Н/Д. gRPC полагается на внешние компоненты для HA/FT. |
| **Kafka** | Полностью реплицированные члены кластера координируются через ZooKeeper. |
| **Pulsar** | Pulsar поддерживает кластерные брокеры с георепликацией. |
| **Rabbit** | Поддержка кластеризации с полной репликацией данных через federation‑плагины. Кластеры требуют низколатентных сетей, где сетевые разделения редки. |

## Deployment

| Проект | Поддерживаемые модели развертывания |
| :--- | :--- |
| **NATS** | Сетевой элемент NATS \(сервер\) — это небольшой статический бинарник, который можно развернуть где угодно: от крупных облачных инстансов до устройств с ограниченными ресурсами, таких как Raspberry PI. NATS поддерживает архитектуру Adaptive Edge, позволяющую создавать крупные и гибкие развертывания. Одиночные серверы, leaf nodes, кластеры и супер‑кластеры \(кластер кластеров\) можно комбинировать произвольным образом для максимально гибкого развертывания, подходящего для облака, on‑premise, edge и IoT. Клиенты не знают о топологии и могут подключаться к любому серверу NATS в развертывании. |
| **gRPC** | gRPC — это point‑to‑point и не имеет сервера или брокера для развертывания и управления, но всегда требует дополнительных компонентов для продакшн‑развертываний. |
| **Kafka** | Kafka поддерживает кластеризацию с зеркалированием в слабо связанные удаленные кластеры. Клиенты привязаны к партициям, определенным внутри кластеров. Серверы Kafka требуют JVM, восьми ядер, 64–128 ГБ ОЗУ, двух или более SAS/SSD дисков по 8 ТБ и 10‑гигабитный NIC. [_\(1\)_](compare-nats.md#references)__ |
| **Pulsar** | Pulsar поддерживает кластеризацию и встроенную георепликацию между кластерами. Клиенты могут подключаться к любому кластеру с корректно настроенными tenant и namespace. Pulsar требует JVM и как минимум 6 Linux‑машин или VM: 3 под ZooKeeper и 3 под брокер Pulsar и bookie BookKeeper. [_\(2\)_](compare-nats.md#references)__ |
| **Rabbit** | Rabbit поддерживает кластеры и распространение сообщений между кластерами через federation‑плагин. Клиенты не знают о топологии и могут подключаться к любому кластеру. Сервер требует Erlang VM и зависимости. |

## Monitoring

| Проект | Инструменты мониторинга |
| :--- | :--- |
| **NATS** | NATS поддерживает экспорт метрик в Prometheus и имеет дашборды Grafana для мониторинга и настройки алертов. Также есть инструменты для разработки, такие как nats-top. Поддерживаются как sidecar‑развертывания, так и простой режим «подключился‑посмотрел» с NATS surveyor. |
| **gRPC** | Для мониторинга gRPC требуются внешние компоненты, такие как service mesh. |
| **Kafka** | Kafka имеет ряд инструментов управления и консолей, включая Confluent Control Center, Kafka, Kafka Web Console, Kafka Offset Monitor. |
| **Pulsar** | CLI‑инструменты, дашборды по темам и сторонние инструменты. |
| **Rabbit** | CLI‑инструменты, система управления на плагинах с дашбордами и сторонние инструменты. |

## Management

| Проект | Инструменты управления |
| :--- | :--- |
| **NATS** | NATS разделяет операции и безопасность. Управление пользователями и аккаунтами может быть децентрализованным и выполняться через CLI. Конфигурация сервера \(сетевого элемента\) отделена от безопасности: используется командная строка и конфигурационный файл, который можно перечитывать с изменениями во время работы. |
| **gRPC** | Для управления gRPC требуются внешние компоненты, такие как service mesh. |
| **Kafka** | Kafka имеет ряд инструментов управления и консолей, включая Confluent Control Center, Kafka, Kafka Web Console, Kafka Offset Monitor. |
| **Pulsar** | CLI‑инструменты, дашборды по темам и сторонние инструменты. |
| **Rabbit** | CLI‑инструменты, система управления на плагинах с дашбордами и сторонние инструменты. |

## Integrations

| Проект | Встроенные и сторонние интеграции |
| :--- | :--- |
| **NATS** | NATS поддерживает WebSockets, Kafka bridge, IBM MQ Bridge, Redis Connector, Apache Spark, Apache Flink, CoreOS, Elastic, Elasticsearch, Prometheus, Telegraf, Logrus, Fluent Bit, Fluentd, OpenFAAS, HTTP и MQTT, а также [многое другое](https://nats.io/download/#connectors-and-utilities). |
| **gRPC** | Существует множество сторонних интеграций, включая HTTP, JSON, Prometheus, Grift и другие. [_\(3\)_](compare-nats.md#references)__ |
| **Kafka** | Kafka имеет множество интеграций в своей экосистеме, включая stream processing \(Storm, Samza, Flink\), Hadoop, базы данных \(JDBC, Oracle Golden Gate\), поиск и запросы \(ElasticSearch, Hive\), а также различные логирующие и другие интеграции. |
| **Pulsar** | Pulsar имеет множество интеграций, включая ActiveMQ, Cassandra, Debezium, Flume, Elasticsearch, Kafka, Redis и другие. |
| **Rabbit** | RabbitMQ имеет множество плагинов, включая протоколы \(MQTT, STOMP\), WebSockets, а также различные плагины авторизации и аутентификации. |

## References

1. [https://docs.cloudera.com/HDPDocuments/HDF3/HDF-3.1.0/bk_planning-your-deployment/content/ch_hardware-sizing.html](https://docs.cloudera.com/HDPDocuments/HDF3/HDF-3.1.0/bk_planning-your-deployment/content/ch_hardware-sizing.html)
2. [https://pulsar.apache.org/docs/4.0.x/deploy-bare-metal/](https://pulsar.apache.org/docs/4.0.x/deploy-bare-metal/)
3. [https://github.com/grpc-ecosystem](https://github.com/grpc-ecosystem)
