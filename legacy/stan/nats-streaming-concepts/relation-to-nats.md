# Связь с NATS

NATS Streaming Server по умолчанию встраивает сервер [NATS](https://github.com/nats-io/nats-server). То есть Streaming-сервер в строгом смысле не является отдельным сервером, а выступает клиентом NATS Server.

Это значит, что Streaming-клиенты подключаются не напрямую к Streaming-серверу, а взаимодействуют с ним _через_ NATS Server.

Эта деталь важна для подключений Streaming-клиентов к Streaming-серверу. Поскольку прямого подключения нет, сервер определяет наличие клиента по heartbeat-сообщениям.

_**Поэтому настоятельно рекомендуется закрывать подключение клиента при завершении приложения, иначе сервер будет считать клиента подключенным \(и продолжающим работу\), пока не обнаружит отсутствие heartbeat-сообщений.**_

Streaming-сервер создает внутренние подписки на определенные subjects для взаимодействия со своими клиентами и/или другими серверами.

Обратите внимание: клиенты NATS и клиенты NATS Streaming не могут обмениваться данными друг с другом. Например, если Streaming-клиент публикует в `foo`, NATS-клиент с подпиской на тот же subject эти сообщения не получит. Streaming-сообщения — это NATS-сообщения в формате protobuf. Streaming-сервер должен отправлять ACK производителям и получать ACK от потребителей. Свободный обмен такими сообщениями с обычными NATS-клиентами вызвал бы проблемы.

