# Управляемые операторы

Вы можете использовать `nsc` для администрирования нескольких операторов. Операторы — это владельцы nats-servers и делятся на две категории: локальные и управляемые. Ключевое различие в том, что управляемые операторы — это те, для которых у вас нет nkey. Пример управляемого оператора — Synadia [NGS](https://www.synadia.com/cloud?utm_source=nats_docs&utm_medium=nats).

Аккаунты, представленные своими JWT, подписываются оператором. Некоторые операторы используют локальные копии JWT (например, через memory resolver), но большинство используют встроенный в `nats-server` NATS account resolver для управления JWT. Synadia использует кастомный сервер для своих JWT, который работает аналогично открытому account server.

Есть несколько специальных команд при работе с серверными операторами:

* Account JWT можно отправить на сервер через `nsc push`
* Account JWT можно получить с сервера через `nsc pull`

Для управляемых операторов это push/pull поведение встроено в `nsc`. Каждый раз, когда вы редактируете account JWT, `nsc` отправляет изменения на сервер управляемого оператора и получает подписанный ответ. Если это не удается, JWT на диске может не совпадать со значением на сервере. Вы можете всегда повторно сделать push или pull аккаунта без редактирования. Примечание: push работает только если JWT оператора был настроен с URL account server.

Управляемый оператор не только подписывает ваш account JWT своим ключом, но и может редактировать JWT, добавляя лимиты, чтобы ограничить ваш доступ к своим NATS servers. Некоторые операторы также добавляют демонстрационные или стандартные импорты. Обычно их можно удалить, хотя финальное решение по правкам аккаунта остается за оператором. Как и в любом развертывании, управляемый оператор не отслеживает user JWT.

Чтобы начать использовать управляемого оператора, нужно сообщить `nsc` о нем. Это можно сделать несколькими способами. Во‑первых, можно вручную сказать `nsc` скачать JWT оператора через команду `add operator`:

```bash
nsc add operator -i
```

JWT оператора (или детали) должен предоставить оператор. Второй способ — команда `init`:

```bash
nsc init -o synadia -n MyFirstAccount
```

Можно использовать имя существующего оператора или хорошо известного (сейчас только "synadia").

После добавления управляемого оператора вы можете добавлять аккаунты как обычно, с той оговоркой, что новые аккаунты автоматически push/pull‑ятся, как описано выше.

## Определение «хорошо известных операторов»

Чтобы определить хорошо известного оператора, вы сообщаете `nsc` об операторе, которого хотите использовать в своей среде по имени, задав переменную окружения вида `nsc_<operator name>_operator`. Значение этой переменной — URL для получения JWT оператора. Например:

```bash
export nsc_zoom_operator=https://account-server-host/jwt/v1/operator
```

Это скажет `nsc`, что есть хорошо известный оператор с именем zoom и его JWT доступен по `https://account-server-host/jwt/v1/operator`. С таким определением вы можете использовать флаг `-u` с именем "zoom", чтобы добавить оператора в директорию `nsc` store.

JWT оператора должен иметь свойство account JWT server, указывающее на соответствующий URL. В нашем примере это:

```bash
nsc edit operator -u https://account-server-host/jwt/v1
```

Можно также задать один или несколько service url. Они позволяют работать с действиями `nsc tool`, такими как pub и sub. Например:

```bash
nsc edit operator -n nats://localhost:4222
nsc tool pub hello world
```
