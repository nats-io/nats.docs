# Подключение

Чтобы клиентское приложение NATS могло подключиться к сервису NATS, а затем подписываться или публиковать сообщения в subject, оно должно быть настроено с деталями подключения к инфраструктуре сервиса NATS и способами аутентификации.

## NATS URL

1. «NATS URL» — строка (в формате URL), которая задаёт IP‑адрес и порт, по которым доступны серверы NATS, и тип соединения:
   * TCP‑соединение, зашифрованное TLS **только** (то есть NATS URL, начинающиеся с `tls://...`)
   * TLS‑шифрование, если сервер настроен на него, или обычное незашифрованное TCP‑соединение иначе (то есть NATS URL, начинающиеся с `nats://...`)
   * WebSocket‑соединение (то есть NATS URL, начинающиеся с `ws://...`)

### Подключение к кластерам

Обратите внимание: при подключении к инфраструктуре NATS с кластерами существует более одного URL, и приложение должно позволять указывать более одного URL в вызове подключения (обычно передают список URL через запятую, например: `"nats://server1:port1,nats://server2:port2"`).

При подключении к кластеру лучше предоставить полный набор «seed» URL для кластера.

## Данные аутентификации

1. При необходимости: данные аутентификации, чтобы приложение могло идентифицировать себя перед сервером(ами) NATS. NATS поддерживает несколько схем аутентификации:
   * [Учетные данные Username/Password](./security/userpass.md) (их можно передавать как часть NATS URL)
   * [Децентрализованная JWT-аутентификация/авторизация](./security/creds.md) (приложение настраивается на путь к «файлу учетных данных», содержащему JWT и приватный Nkey)
   * [Аутентификация токеном](./security/token.md#connecting-with-a-token) (приложение настраивается строкой токена)
   * [TLS‑сертификат](./security/tls.md#connecting-with-tls-and-verify-client-identity) (клиент использует клиентский TLS‑сертификат, а серверы сопоставляют TLS‑сертификаты клиентов пользователям, заданным в конфигурации сервера)
   * [NKEY с challenge](./security/nkey.md) (клиент настраивается Seed и User NKeys)

### Конфигурация во время выполнения

Приложение должно предоставлять способ настройки во время выполнения с NATS URL(ами), которые нужно использовать. Если требуется безопасная инфраструктура, приложение должно позволять задавать либо файл учетных данных (.creds), либо способ кодировать токен или Nkey в URL(ах).

## Опции подключения

Помимо параметров подключения и безопасности, существует множество опций соединения NATS: от [таймаутов](../reconnect/README.md#connection-timeout-attributes) до [настроек переподключения](../reconnect/README.md#reconnection-attributes) и назначения [асинхронных обработчиков ошибок и событий подключения](../reconnect/README.md#advisories) в вашем приложении.

## См. также

WebSocket and NATS

{% embed url="https://www.youtube.com/watch?v=AbAR9zgJnjY" %}
WebSocket and NATS | Hello World
{% endembed %}

NATS WebSockets and React

{% embed url="https://www.youtube.com/watch?v=XS_Q0i6orSk" %}
NATS WebSockets and React
{% endembed %}
