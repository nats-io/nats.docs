## Сравнение возможностей NATS
Это сравнение — краткое резюме основных компонентов нескольких популярных сегодня технологий обмена сообщениями. Это не исчерпывающий список, и каждую технологию следует изучить подробно, чтобы выбрать оптимальную для вашей реализации.

В сравнении участвуют NATS, Apache Kafka, RabbitMQ, Apache Pulsar и gRPC.

<html>
<body>
<table>
    <tr>
        <td rowspan="5" valign="top"><b>
            Поддержка языков и платформ
            </b>
        </td>
        <td><b>
            NATS
            </b>
        </td>
        <td>
            Core NATS: 48 известных типов клиентов, 11 поддерживаются мейнтейнерами, 18 предоставлены сообществом. NATS Streaming: 7 типов клиентов поддерживаются мейнтейнерами, 4 — сообществом. Серверы NATS можно собирать под архитектуры, поддерживаемые Golang. NATS предоставляет бинарные дистрибутивы.
        </td>
    </tr>
    <tr>
        <td><b>
            Kafka
            </b>
        </td>
        <td>
            18 типов клиентов поддерживаются сообществом и Confluent. Серверы Kafka работают на платформах с поддержкой Java; поддержка очень широкая.
        </td>
    </tr>
    <tr>
        <td><b>
            Rabbit
            </b>
        </td>
        <td>
            Не менее 10 клиентских платформ поддерживаются мейнтейнерами, более 50 типов клиентов поддерживаются сообществом. Серверы поддерживаются на следующих платформах: Linux, Windows, NT.
        </td>
    </tr>
    <tr>
        <td><b>
            Pulsar
            </b>
        </td>
        <td>
            7 языков клиентов, 5 клиентов от сторонних разработчиков — тестируется на macOS и Linux.
        </td>
    </tr>
    <tr>
        <td><b>
            gRPC
            </b>
        </td>
        <td>
            13 языков клиентов.
        </td>
    </tr>
    <tr>
        <td rowspan="5" valign="top"><b>
            Встроенные паттерны
            </b>
        </td>
        <td><b>
            NATS
            </b>
        </td>
        <td>
            Стримы и сервисы через встроенные паттерны publish/subscribe, request-reply и балансируемые очереди подписчиков. Поддерживаются динамические права на запросы и обфускация subject для запросов.
        </td>
    </tr>
    <tr>
        <td><b>
            Kafka
            </b>
        </td>
        <td>
            Стримы через publish/subscribe. Балансировку нагрузки можно получить через consumer groups. Код приложения должен сопоставлять запросы с ответами по нескольким топикам для паттерна сервиса (request-reply).
        </td>
    </tr>
    <tr>
        <td><b>
            Rabbit
            </b>
        </td>
        <td>
            Стримы через publish/subscribe, сервисы — с direct reply-to. Балансировка нагрузки достигается через Work Queue. Приложения должны сопоставлять запросы с ответами по нескольким топикам для паттерна сервиса (request-reply).
        </td>
    </tr>
    <tr>
        <td><b>
            Pulsar
            </b>
        </td>
        <td>
            Стримы через publish/subscribe. Несколько паттернов конкурирующих потребителей поддерживают балансировку нагрузки. Код приложения должен сопоставлять запросы с ответами по нескольким топикам для паттерна сервиса (request-reply).  
        </td>
    </tr>
    <tr>
        <td><b>
            gRPC
            </b>
        </td>
        <td>
            Один сервис (возможно со streaming‑семантикой) на канал. Балансировку нагрузки для сервиса можно делать либо на стороне клиента, либо через прокси.
        </td>
    </tr>
    <tr>
        <td rowspan="5" valign="top"><b>
            Гарантии доставки
            </b>
        </td>
        <td><b>
            NATS
            </b>
        </td>
        <td>
            В JetStream доступны «не более одного», «как минимум один» и «ровно один».
        </td>
    </tr>
    <tr>
        <td><b>
            Kafka
            </b>
        </td>
        <td>
            «Как минимум один», «ровно один».
        </td>
    </tr>
    <tr>
        <td><b>
            Rabbit
            </b>
        </td>
        <td>
            «Не более одного», «как минимум один».
        </td>
    </tr>
    <tr>
        <td><b>
            Pulsar
            </b>
        </td>
        <td>
            «Не более одного», «как минимум один» и «ровно один».  
        </td>
    </tr>
    <tr>
        <td><b>
            gRPC
            </b>
        </td>
        <td>
            «Не более одного».
        </td>
    </tr>
    <tr>
        <td rowspan="5" valign="top"><b>
            Мульти‑тенантность и совместное использование
            </b>
        </td>
        <td><b>
            NATS
            </b>
        </td>
        <td>
            NATS поддерживает истинную мульти‑тенантность и децентрализованную безопасность через аккаунты, а также определение общих стримов и сервисов.
        </td>
    </tr>
    <tr>
        <td><b>
            Kafka
            </b>
        </td>
        <td>
            Мульти‑тенантность не поддерживается.
        </td>
    </tr>
    <tr>
        <td><b>
            Rabbit
            </b>
        </td>
        <td>
            Мульти‑тенантность поддерживается через vhost, но совместное использование данных не поддерживается.
        </td>
    </tr>
    <tr>
        <td><b>
            Pulsar
            </b>
        </td>
        <td>
            Мульти‑тенантность реализована через tenants; встроенное совместное использование данных между tenants не поддерживается. Каждый tenant может иметь собственную схему аутентификации и авторизации.  
        </td>
    </tr>
    <tr>
        <td><b>
            gRPC
            </b>
        </td>
        <td>
            Н/Д
        </td>
    </tr>
    <tr>
        <td rowspan="5" valign="top"><b>
            AuthN
            </b>
        </td>
        <td><b>
            NATS
            </b>
        </td>
        <td>
            NATS поддерживает TLS, учетные данные NATS, NKEYS (ключи NATS ED25519), имя пользователя и пароль или простой токен.
        </td>
    </tr>
    <tr>
        <td><b>
            Kafka
            </b>
        </td>
        <td>
            Поддерживает Kerberos и TLS. Поддерживает JAAS и встроенную реализацию авторизатора, которая использует ZooKeeper для хранения соединений и subject.
        </td>
    </tr>
    <tr>
        <td><b>
            Rabbit
            </b>
        </td>
        <td>
            TLS, SASL, имя пользователя и пароль, а также подключаемая авторизация.
        </td>
    </tr>
    <tr>
        <td><b>
            Pulsar
            </b>
        </td>
        <td>
            TLS‑аутентификация, Athenz, Kerberos, аутентификация JSON Web Token.  
        </td>
    </tr>
    <tr>
        <td><b>
            gRPC
            </b>
        </td>
        <td>
            TLS, ALT, токен, учетные данные канала и вызова, а также механизм плагинов.
        </td>
    </tr>
    <tr>
        <td rowspan="5" valign="top"><b>
            AuthZ
            </b>
        </td>
        <td><b>
            NATS
            </b>
        </td>
        <td>
            Лимиты аккаунта, включая количество соединений, размер сообщения, количество импортов и экспортов. Разрешения publish и subscribe на уровне пользователя, ограничения соединений, ограничения по CIDR‑адресам и по времени суток.
        </td>
    </tr>
    <tr>
        <td><b>
            Kafka
            </b>
        </td>
        <td>
            Поддерживает JAAS, ACL для широкого набора ресурсов Kafka, включая topics, clusters, groups и другие.
        </td>
    </tr>
    <tr>
        <td><b>
            Rabbit
            </b>
        </td>
        <td>
            ACL задают права на configure, write и read операции над ресурсами вроде exchanges, queues, transactions и т. п. Аутентификация подключаемая.
        </td>
    </tr>
    <tr>
        <td><b>
            Pulsar
            </b>
        </td>
        <td>
            Разрешения могут выдаваться конкретным ролям на наборы операций, таких как produce и consume.  
        </td>
    </tr>
    <tr>
        <td><b>
            gRPC
            </b>
        </td>
        <td>
            Пользователи могут настраивать call credentials для авторизации отдельных вызовов сервиса с высокой детализацией.
        </td>
    </tr>
    <tr>
        <td rowspan="5" valign="top"><b>
            Хранение и устойчивость сообщений
            </b>
        </td>
        <td><b>
            NATS
            </b>
        </td>
        <td>
            Поддерживает хранение в памяти, файле и базе данных. Сообщения можно воспроизводить по времени, количеству или номеру последовательности; поддерживаются durable‑подписки. В NATS Streaming скрипты могут архивировать старые сегменты лога в холодное хранилище.
        </td>
    </tr>
    <tr>
        <td><b>
            Kafka
            </b>
        </td>
        <td>
            Поддерживает файловое хранение. Сообщения можно воспроизводить, задав offset; поддерживаются durable‑подписки. Также поддерживается лог‑компакция и KSQL.
        </td>
    </tr>
    <tr>
        <td><b>
            Rabbit
            </b>
        </td>
        <td>
            Поддерживает файловое хранение. Rabbit использует семантику очередей (а не лога), поэтому повторное воспроизведение сообщений недоступно.
        </td>
    </tr>
    <tr>
        <td><b>
            Pulsar
            </b>
        </td>
        <td>
            Поддерживает многоуровневое хранение, включая файл, Amazon S3 или Google Cloud Storage (GCS). Pulsar может воспроизводить сообщения с заданной позиции и поддерживает durable‑подписки. Поддерживаются Pulsar SQL и topic compaction, а также Pulsar functions. 
        </td>
    </tr>
    <tr>
        <td><b>
            gRPC
            </b>
        </td>
        <td>
            Н/Д
        </td>
    </tr>
    <tr>
        <td rowspan="5" valign="top"><b>
            Высокая доступность/отказоустойчивость
            </b>
        </td>
        <td><b>
            NATS
            </b>
        </td>
        <td>
            Core NATS поддерживает полносвязную кластеризацию с самоисцелением для обеспечения высокой доступности клиентам. NATS Streaming имеет резервные серверы warm failover с двумя режимами (FT и полная кластеризация). JetStream поддерживает горизонтальное масштабирование со встроенным зеркалированием.
        </td>
    </tr>
    <tr>
        <td><b>
            Kafka
            </b>
        </td>
        <td>
            Полностью реплицированные участники кластера координируются через Zookeeper.
        </td>
    </tr>
    <tr>
        <td><b>
            Rabbit
            </b>
        </td>
        <td>
            Поддержка кластеров с полной репликацией данных через плагины federation. Кластеры требуют низкой латентности сетей, где разделение сети случается редко.
        </td>
    </tr>
    <tr>
        <td><b>
            Pulsar
            </b>
        </td>
        <td>
            Pulsar поддерживает кластерные брокеры с гео‑репликацией.
        </td>
    </tr>
    <tr>
        <td><b>
            gRPC
            </b>
        </td>
        <td>
            Н/Д. gRPC опирается на внешние ресурсы для HA/FT.
        </td>
    </tr>
</table>
</body>
</html>
